<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="" name="keyword">
<meta content="" name="description">
<meta content="Niels Christensen" name="author">
<title>BriefMe</title>
</head>

<body>
<table>
<tr>
<td>
	<input type="text" id="lookup"></input>
	<button onclick="lookup();">Go</button>

	<div id="options">
	</div>
</td>
<td>
	<div id="show" style="width:300px">
		
	</div>
</td>
</tr>
</table>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>

<script type="text/javascript">
function lookup() {
	$( "#options" ).empty();
	$( "#show" ).empty();
	var search_for = $( '#lookup' ).val();
	$.ajax({
    url: "http://lookup.dbpedia.org/api/search/KeywordSearch",
    data: {
      "QueryString" : search_for,
      "MaxHits" : 10
    },
    dataType: 'json',
    success: function( response ) {
      $.each( response.results, _add_result );
    },
    timeout: 4000,
  });
}
function _add_result( index, result ) {
	var content_uri = '/get-item/dbpedia-resource/'+encodeURIComponent(result.uri.split("/").pop());
	$( "#options" ).append( "<p></p>" );
	$( "#options p:last" ).on( "click", function() {
  	  show(content_uri);
	});
	$( "#options p:last" ).append( "<b></b>: " );
	$( "#options p:last b" ).append( result.label );
	$( "#options p:last" ).append( "<small></small>" );
	$( "#options p:last small" ).append( result.description );
}
function show(uri){
	$.ajax({
    url: uri,
    dataType: 'json',
	statusCode: {
    	204: function( response ) {
      			$( "#show" ).append( "<p>Working...</p>" );
      			setTimeout(function(){show(uri);} , 2500 );
    	},
    	200: function( response ) {
      			$( "#show" ).empty();
      			$.each( response, _show_abstract );
    	}
    },
    timeout: 1500,
  });	
}
function _show_abstract( index, abstract ) {
	$( "#show" ).append( "<p>" + abstract + "</p>" )
}
</script>
</html>